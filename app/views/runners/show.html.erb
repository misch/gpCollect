<p id="notice"><%= notice %></p>
<h1>Runner</h1>
<p>
  <strong>First name:</strong>
  <%= @runner.first_name %>
</p>

<p>
  <strong>Last name:</strong>
  <%= @runner.last_name %>
</p>

<p>
  <strong>Birth date:</strong>
  <%= @runner.birth_date %>
</p>

<p>
  <strong>Sex:</strong>
  <%= @runner.sex %>
</p>

<p>
  <strong>Club or Hometown:</strong>
  <%= @runner.club_or_hometown %>
</p>

<h1>Runs</h1>

<% if @runner.runs.empty? %>
    No runs available
<% else %>
    <script type="text/javascript" charset="utf-8">
        $(function(){
            new Highcharts.Chart({
                chart: {
                    renderTo: "runs_chart"
                },
                title: {
                    text: "Runs"
                },
                xAxis: {
                    type: "datetime"
                },
                yAxis: {
                    type: 'datetime', // y-axis will be in milliseconds
                    dateTimeLabelFormats: { // force all formats to be hour:minute:second
                        second: '%H:%M:%S',
                        minute: '%H:%M:%S',
                        hour: '%H:%M:%S',
                        day: '%H:%M:%S',
                        week: '%H:%M:%S',
                        month: '%H:%M:%S',
                        year: '%H:%M:%S'
                    },
                        yDateFormat: '%H:%M:%S',
                        shared: true,
                        yType: 'datetime'
                },
                tooltip: {
                    formatter: function() {
                        return '<b>' + this.series.name +'</b><br/>' +
                                Highcharts.dateFormat('%e. %b. %Y', new Date(this.x)) + '<br/>' +
                                Highcharts.dateFormat('%H:%M:%S', new Date(this.y));
                    }
                },
                series: [{
                    name: "<%= @runner.first_name %> <%= @runner.last_name %>",
                    data: [<%= @runner.runs.includes(:run_day).reverse.map {|r| "[#{ruby_to_javascript_date(r.run_day.date)}, #{r.duration}]" }.join(',') %>]
                }]
            });
        });
    </script>
    <div id="runs_chart" style="width:560px; height:300px;"></div>

    <table class="table table-striped">
      <thead>
      <th>Day</th>
      <th>Category</th>
      <th>Duration</th>
      </thead>
      <% @runner.runs.decorate.each do |run| %>
          <tr>
            <td><%= I18n.l run.run_day.date %></td>
            <td><%= run.category.name %></td>
            <td><%= run.duration %></td>
          </tr>
      <% end %>
    </table>
<% end %>
<%= link_to 'Edit', edit_runner_path(@runner) %> |
<%= link_to 'Back', runners_path %>
